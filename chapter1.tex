\chapter{ОБЗОР ЛИТЕРАТУРЫ}\label{chap1}
В данной главе собраны теоретические сведения об управлении по прогнозирующей моделии (далее $ - $ MPC), а так же о его модификации --- экономическом MPC. Рассматриваются различные подходы к построению аппроксимирующих задач.
\section{Теория управления по прогнозирующей модели}\label{MPC}
Управление по прогнозирующей модели (далее MPC, от англ. Model Predictive Control) --- это продвинутый метод управления процессами, который используется для соответствующего набора ограничений. Оно используется в перерабатывающей индустрии, на химических заводах и нефтепереработке с 80-х годов ХХ-го века. Сейчас данный метод так же используется при калибровке энергетических систем и силовой электронике. В МРС в основном используются динамические модели процессов, наиболее часто --- линейные эмпирические. Главным приимуществом MPC является то, что он способен оптимизировать текущий временной отрезок, учитывая будущие интервалы.

Модели, используемые в MPC, направлены на то, чтобы отражать поведение сложных динамических систем. Они предсказывают изменения в зависимых переменных моделируемых систем благодаря изменениям независимых переменных. Например если речь идет о химических процессах, независимые переменные, которые могут быть добавлены регулятором чаще всего являются либо установками ПИД-регуляторов, либо конечными контрольными элементами.

В основе MPC лежит итеративная оптимизация модели производства. В момент времени $t$ производится выборка текущего состояния производства и вычисляется стратегия управления минимизацией затрат (с помощью алгоритма численной минимизации) для относительно короткого временного горизонта в будущем: $[t,t+T]$. В частности, онлайн-расчет или расчет «на лету» используются для изучения траекторий состояния, которые исходят из текущего состояния, и находят (посредством решения задач оптимального управления) стратегию минимизации затрат до времени $t+T$.

Реализуется только первый шаг стратегии управления, затем снова производится выборка состояния производства, и вычисления повторяются, начиная с нового текущего состояния, получая новый элемент управления и новый прогнозируемый путь состояния. Горизонт прогнозирования продолжает смещаться вперед, и по этой причине MPC также называют сдвигающимся горизонтом управления(англ.  Receding horizon control).

Хотя этот подход не является оптимальным, на практике он дал очень хорошие результаты. Было сделано много научных исследований, чтобы найти быстрые методы решения задач оптимального управления, понять глобальные свойства устойчивости локальной оптимизации MPC и в целом улучшить метод MPC.


\paragraph{Основные принципы MPC}
\normalsize{
	Управление по прогнозирующей модели это алгоритм управления, который использует:
	\begin{itemize}
		\item  внутреннюю динамическую модель процесса;
		\item функцию стоимости $ J $ над сдвигающимся горизонтом;
		\item алгоритм оптимизации, минимизирующий функцию стоимости $J$ с использованием управления $ u  $;
	\end{itemize}
	
	Из приведенного краткого обзора методов MPC понятно, что их основу составляет решение задач оптимального управления на сдвигающемся горизонте управления с изменяющимся начальным состоянием. Поэтому в следующем разделе опишем основные результаты теории управления.
	\section{Системы управления}\label{MPC}
	
	Рассмотрим нелинейные системы в непрерывном времени следующего вида:
	\begin{equation}
	\dot{x}(t) = f(x(t),u(t),\omega(t)), t \ge 0,
	\end{equation}
	где $ x \in X \subseteq \mathbb{R}^n $ --- вектор состояния, $ u \in U \subset \mathbb{R}^r $ --- вектор управления, $ \omega \in W \subset \mathbb{R}^m $ --- вектор возмущений, $ \dot{x} = dx/dt $. Через $ X $ обозначим множесто допустимых состояний, через $ U - $ множество допустимых управлений. Вектор возмущений включает в себя неучтённые воздействия на систему, ошибки моделирования и прочие неопределённости, влияющие на систему, и ограничен множеством $ W $. 
	
	В дополнение к нелинейным системам в непрерывном времени, в MPC в данной работе мы рассмотрим и другие модели. В частности, это могут быть нелинейные системы в дискретном времени, полученные дискретизацией систем в непрерывном времени вида (1.1). Дискретный аналог системы, заданной уравнением (1.1), определяется следующим нестационарным разностным уравнением
	\begin{equation}
	x(k + 1) = f_d(x(k), u(k), \omega(k)), k = 0, 1, . . . ,
	\end{equation}
	где $ x, u, и w $ имеют тот же смысл и размерность, что и выше, $ k $ --- текущий
	момент времени. Правая часть динамической системы задается функцией $ f_d $,
	где индекс $ d $ используется, чтобы отличать динамику в дискретном времени
	от динамики в непрерывном времени $ f $.
	
	
	Предполагается, что измерение состояния системы возможно в моменты времени $\tau_k = \tau_0 + kh $, где $ h $ --- период дискретизации. Таким образом $ k $-ый шаг дискретной системы (1.2) соответствует моменту $ \tau_k $. Чтобы различать непрерывное и дискретное время, обозначение $ t $ будем использовать для непрерывного времени, а $ \tau_k $ и $ k $ --- для дискретных моментов для модели в непрерывном времени и для модели в дискретном времени, соответственно.
	
	В дальнейшем в работе будут рассматриваться системы с $ \omega(t) \equiv 0 $. Траектория, полученная путём решения уравнения (1.1) при $ \omega(t) \equiv 0 $ для заданного начального состояния $ x(0) = x_0 $ и управления $ u(\cdot) $ называется номинальной и обозначается $ \varphi (t|x_0, u(\cdot)), t \ge 0 $. Если $ f(x, u, \omega) $ непрерывно
	дифференцируемая функция своих аргументов, то такая траектория существует и единственна для любого $ t $.
	
	Относительно ограничений на состояние и управление предполагается,
	что x принадлежит множеству $ X \subseteq \mathbb{R}^n $ (то есть множество $ X $ может быть как подмножеством $ \mathbb{R}^n $, так и множеством, равным $ \mathbb{R}^n $). Случай $ X = \mathbb{R}^n $ соответствует задаче без ограничений на состояние $ x $. В то же время предполагается, что управление $ u $ принадлежит множеству $ U \subset \mathbb{R}^r $. Предположение, что $ U $ может быть исключительно подмножеством $ \mathbb{R}^r $ исходит из физических ограничений на механизмы управления.
	
	Множества $ X, U $, как правило, являются множествами простой структуры (шар, параллелепипед, иногда, выпуклый многогранник). Обычно на состояния и управления задаются дополнительные ограничения, следующие из физических ограничений для управляемого объекта, в виде смешанного ограничения
	\begin{equation}
	g(x(t),u(t)) \le 0 \quad \forall t \ge 0.
	\end{equation}
	
	Наконец, предпологается, что возмущения ограничны некоторым подмножеством $ W \subset \mathbb{R}^m $, в связи с тем, что для отдельных систем управления устойчивость замкнутого контура доказана для достаточно малых возмущений.
	
	В общем случае устойчивость для системы (1.1) достаточно трудно доказать при неограниченных возмущениях. Обычно считается, что $ W - $ простое множество.
	\section{Методы MPC}\label{MPC}
	
	В данном подразделе мы рассмотрим методы MPC для решения задач стабилизации и приведем алгоритм, используемый в этих целях. 
	
	Для измерения качества процесса управления рассматриваемыми системами (1.1) или (1.2) используется функция:
	\begin{center}
		$ l:\mathbb{R}^n \times \mathbb{R}^r \rightarrow \mathbb{R} $
	\end{center}
	называемая функцией мгновенной стоимости в случае системы (1.1) или стоимости этапа в случае (1.2). Функция $ l $ отражает экономические требования процессу, такие как минимизация расходов или максимизация прибыли.
	
	Устойчивым состоянием называется решение следующей задачи минимизации:
	\begin{equation}
	l(x,u) \rightarrow \underset{x, u}{\min}
	f(x,u,0) = 0,
	g(x,u) \le 0.
	\end{equation}
	Решение данной задачи обозначается $ (x_*,u_*) $.
	
	Не нарушая общности далее предполагается, что устойчивое состояние единственное. Кроме того заменой переменных в системе (1.1) можно добиться $ x_* = 0, u_* = 0 $, то есть точка оптимального устойчивого состояния находится в начале координат.
	
	Во многих задачах целью управления является переход системы как можно ближе к состоянию $ (x_*,u_*) $, т.е. стабилизация этого состояния.
	
	Методы управления по прогнозирующей модели (МРС) достигают этой цели посредством повторяющегося в режиме реального времени решения вспомогательных (они называются прогнозирующими) задач оптимального управления на конечном промежутке $ [\tau_k, \tau_k + \tau_N ]. $ Оптимальное решение прогнозирующей задачи (программное решение) выбирается для управления системой
	на промежутке $ [\tau_k, [\tau_{k+1}) $, после чего строится и решается новая прогнозирующая задача для следующего промежутка.
	
	При $ (x_*, u_*) = (0, 0) $ прогнозирующая задача оптимального управления может быть записана в виде:
	$$ \int_{0}^{\tau_N}(\Vert\varphi(t|x(\tau_k),u(\cdot))\Vert^2_Q + \Vert u(t)\Vert^2_R)dt \rightarrow \underset{u}{\min}, $$
	\begin{equation}
	\dot{\varphi}(t|x(\tau_k),u(\cdot)) = f(\varphi(t|x(\tau_k),u(\cdot)), u(t), 0),
    \end{equation}
	$$ g(\varphi(t|x(\tau_k),u(\cdot)), u(t)) \le 0, $$
	$$ \varphi(t|x(\tau_k),u(\cdot)) \in X, u(t) \in U, \forall t \in [0, \tau_N]. $$
	
	В критерии качества задачи (1.4) взвешенная норма определяется стандартно: $ \Vert x\Vert^2_Q = x^T Qx, Q > 0 $. Тогда в критерии $ Q $ и $ R $ положительно определённые матрицы, параметры настройки MPC-системы. Они отвечают за баланс между скоростью стабилизации и стоимостью переходного процесса. 
	
	В прогнозирующей задаче (1.4) математическая модель динамической системы совпадает с номинальной системой (1.1) и $ \varphi(t|x(\tau_k),u(\cdot)) $ предсказываемое состояние системы (1.1). Это означает, что, несмотря на наличие возмущений в динамике управляемого объекта, предсказания для него строятся по детерминированной модели. Такой подход соответствует классическим результатам МРС [10] или классическому синтезу оптимальных управлений типа обратной связи в задачах оптимального управления [14].
	
	Начальное состояние номинальной системы задается условием $ x(0) = x(\tau_k) $, где $ x(\tau_k) $ текущее измеренное состояние объекта управления.
	
	Горизонт управления и прогнозирования $ \tau_N > 0 $ конечен. Для эффективного численного решения прогнозирующей задачи оптимального управления (1.4) горизонт должен быть небольшим. С другой стороны, при недостаточ-
	но больших горизонтах управления МРС-регулятор не сможет обеспечить устойчивость замкнутой системы. Оценки для длины горизонта строятся в рамках так называемого безусловного МРС в работе [8].
	
	Существуют различные подходы к модификациям базовой прогнозирующей задачи (1.4), позволяющие стабилизировать систему (1.1) при коротких горизонтах управления, для чего в задачу добавляются дополнительные терминальные ограничения и терминальная стоимость в критерий качества [4,7].
	
	Пусть $ u^0(t|x(\tau_k)), t \in [0, \tau_N ], $ оптимальное программное управление в
	задаче (1.4), т.е. такая функция, которая порождает траекторию $  \varphi^0(t|x(\tau_k)) =\varphi(t|x(\tau_k), u_0(\cdot)), t \in [0, \tau_N ]$, вместе с которой оно удовлетворяет всем ограничениям задачи и доставляет минимум критерию качества.
	
	Как уже отмечалось выше, алгоритм управления по принципу МРС состоит в том, чтобы решать задачу (1.4) для $ x(\tau_k) $ последовательно для каждого $ k = 0, 1, . . . $. Управление, которое применяется к объекту управления
	значение оптимального программного управления в начальный момент времени, т.е.
	\begin{equation}
	u(t) \equiv u_{MPC}(\tau_k) := u^0(0|x(\tau_k)), t \in [\tau_k, \tau_{k+1} ]
	\end{equation}
	Поскольку построенное управление (1.5) зависит от состояния объекта, оно является управлением типа обратной связи, и таким образом, алгоритм МРС обеспечивает управление системой по принципу замкнутого контура.
	
	Суммируя, алгоритм MPC имеет следующие шаги:
	\begin{enumerate}
		\item Положить $ k = 0 $.
		\item Решить задачу (1.4) для $ x(\tau_k), $ найти $ u^0(\cdot|x(\tau_k)) $
		\item Подавать на вход объекта управления постоянное управление $ u_{MPC}(\tau_k) := u^0(0|x(\tau_k))$ до наступления момента $ \tau_{k+1} $.
		\item Положить $ k:=k+1 $, вернуться к шагу 2.
	\end{enumerate}
	Система (1.1) с управлением (1.5) замкнутая система является асимптотически устойчивой при выполнении ряда условий на функцию $ f $, матрицы
	$ Q, R $ и горизонт управления $ \tau_N  $ [8] или дополнительных терминальных условия в прогнозирующей задаче оптимального управления [4, 7].
